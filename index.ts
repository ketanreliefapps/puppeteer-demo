import puppeteer from 'puppeteer';
import moment from 'moment';
async function generatePdf() {
    const browser = await puppeteer.launch({args: [
        "--no-sandbox",
        "--disable-setuid-sandbox",
      ],headless: false});
    const page = await browser.newPage();
    
    await page.evaluateOnNewDocument(async () => {
        localStorage.clear();
        localStorage.setItem('idtoken', 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJxcVFRZElCNzFxaFpWbDBiSXo5OFd2R1VqaHk3TlR5Q1g1U3ZPRVhya29jIn0.eyJleHAiOjE2NzU0MzEyMzUsImlhdCI6MTY3NTQyOTQzNSwiYXV0aF90aW1lIjoxNjc1NDA3MDcwLCJqdGkiOiI1Y2E2N2M2OC0yZGMyLTRmNGYtYTc1Ni04NjZhZWJhOTFhOGYiLCJpc3MiOiJodHRwczovL2lkLWRldi5vb3J0Y2xvdWQudGVjaC9hdXRoL3JlYWxtcy9vb3J0IiwiYXVkIjoib29ydC1jbGllbnQiLCJzdWIiOiJmODBmNGMyZS01YjVkLTQwZmYtOTY0OS05Njc1MDc2MmNiYjEiLCJ0eXAiOiJJRCIsImF6cCI6Im9vcnQtY2xpZW50Iiwibm9uY2UiOiJOVTF2YldGNVpYcEliV1I0WDNkTE5YWXlSV1JhU1VWV0xXY3RUMUZCZUd0NE5IRk1OVkZYVkUxalZsaEMiLCJzZXNzaW9uX3N0YXRlIjoiOGRmOTJmZGItOWRiYS00ZDU4LWJhYWItODQ1NWYyM2UyNzM0IiwiYXRfaGFzaCI6InNNMzJNb1pGOTh4ZGRFbmNOaHpScnciLCJhY3IiOiIxIiwic2lkIjoiOGRmOTJmZGItOWRiYS00ZDU4LWJhYWItODQ1NWYyM2UyNzM0IiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJrZXRhbiBtb2RpIiwicHJlZmVycmVkX3VzZXJuYW1lIjoia2V0YW4ucmVsaWVmYXBwc0BnbWFpbC5jb20iLCJnaXZlbl9uYW1lIjoia2V0YW4iLCJmYW1pbHlfbmFtZSI6Im1vZGkiLCJlbWFpbCI6ImtldGFuLnJlbGllZmFwcHNAZ21haWwuY29tIn0.UzGQxImd_N15G1GAI_G4yqsEoKgr__P2LpadH8EMjpYfI4g15NHnrbZFeVfmCjpgDC3ujhzHtcDi2VhIdVQj_-P4IxbWzDR8XUt4cKZB2UpBjOx8B4Lwhku6iNXLTiyJ_mLosmhIhg9v2HO2BbnaouzJ86tglAeFXJD4yJlM1lX2CBYX46Xi0FDBGTsbHlAxk87GBinTVr7IrJak3xFD5uCdS5oqomBSULf78Q-DjTcaE-ansJIuURDHd798b_6ZGqW1RpT_OJmwemcheQlNQQk6oziKgGa-UCVN0rh7E6brLl0K6nGDl428k8ZKMXmCN8tT0g7DGbJIUMbjZq2GAw');
        localStorage.setItem('access_token', 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJxcVFRZElCNzFxaFpWbDBiSXo5OFd2R1VqaHk3TlR5Q1g1U3ZPRVhya29jIn0.eyJleHAiOjE2NzU0MzEyMzUsImlhdCI6MTY3NTQyOTQzNSwiYXV0aF90aW1lIjoxNjc1NDA3MDcwLCJqdGkiOiI0NGZjNzQ5MS1jZjcxLTRlZjAtOGNiNy0wYzE5NzVhMWU3OTUiLCJpc3MiOiJodHRwczovL2lkLWRldi5vb3J0Y2xvdWQudGVjaC9hdXRoL3JlYWxtcy9vb3J0IiwiYXVkIjoiYWNjb3VudCIsInN1YiI6ImY4MGY0YzJlLTViNWQtNDBmZi05NjQ5LTk2NzUwNzYyY2JiMSIsInR5cCI6IkJlYXJlciIsImF6cCI6Im9vcnQtY2xpZW50Iiwibm9uY2UiOiJOVTF2YldGNVpYcEliV1I0WDNkTE5YWXlSV1JhU1VWV0xXY3RUMUZCZUd0NE5IRk1OVkZYVkUxalZsaEMiLCJzZXNzaW9uX3N0YXRlIjoiOGRmOTJmZGItOWRiYS00ZDU4LWJhYWItODQ1NWYyM2UyNzM0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwczovL3dpZGdldHMub29ydGNsb3VkLnRlY2giLCJodHRwOi8vbG9jYWxob3N0OjQyMDEiLCJodHRwczovL29vcnQtZGV2Lm9vcnRjbG91ZC50ZWNoIiwiaHR0cDovL2xvY2FsaG9zdDo0MjAwIiwiaHR0cDovL2xvY2FsaG9zdDozMDAwIiwiaHR0cHM6Ly9kM3J2NG05cGNyOGxnMi5jbG91ZGZyb250Lm5ldCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJkZWZhdWx0LXJvbGVzLW9vcnQiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIGVtYWlsIG9mZmxpbmVfYWNjZXNzIHByb2ZpbGUiLCJzaWQiOiI4ZGY5MmZkYi05ZGJhLTRkNTgtYmFhYi04NDU1ZjIzZTI3MzQiLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwibmFtZSI6ImtldGFuIG1vZGkiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJrZXRhbi5yZWxpZWZhcHBzQGdtYWlsLmNvbSIsImdpdmVuX25hbWUiOiJrZXRhbiIsImZhbWlseV9uYW1lIjoibW9kaSIsImVtYWlsIjoia2V0YW4ucmVsaWVmYXBwc0BnbWFpbC5jb20ifQ.T8Mis-Ng2sBY2_NsncrlzbfnQxOLeHWeEm5eMo47B8h-eOzFF52gtDg0NGq858QzM-CtQNKr9tDn_EIQsUrEznTWrm_eb4h8fbhAeDBlFjtu7_tNqFjdVkrqEBQVxZtxNFUip3yPhv5vtguAsHw45bTE-2UwB1idb7wedhnEAdhNyGJR_fnziSVRmeUIKN2GOdEVdrgsHdTE7NYQ504SLpBtHiVs4-ssZpcbTncgSIhrcwyohqZKS-TU7kzKIZ1a3j4uvaQ2SI86hc6WeoOg_DaaKDemH65oQIWAjN23xuZ7YOWHfs8NRmG3IQN5qDtdvhH-8qkttSHS6Cl7DDSjvQ');
        localStorage.setItem('id_token', 'eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJxcVFRZElCNzFxaFpWbDBiSXo5OFd2R1VqaHk3TlR5Q1g1U3ZPRVhya29jIn0.eyJleHAiOjE2NzU0MzEyMzUsImlhdCI6MTY3NTQyOTQzNSwiYXV0aF90aW1lIjoxNjc1NDA3MDcwLCJqdGkiOiI1Y2E2N2M2OC0yZGMyLTRmNGYtYTc1Ni04NjZhZWJhOTFhOGYiLCJpc3MiOiJodHRwczovL2lkLWRldi5vb3J0Y2xvdWQudGVjaC9hdXRoL3JlYWxtcy9vb3J0IiwiYXVkIjoib29ydC1jbGllbnQiLCJzdWIiOiJmODBmNGMyZS01YjVkLTQwZmYtOTY0OS05Njc1MDc2MmNiYjEiLCJ0eXAiOiJJRCIsImF6cCI6Im9vcnQtY2xpZW50Iiwibm9uY2UiOiJOVTF2YldGNVpYcEliV1I0WDNkTE5YWXlSV1JhU1VWV0xXY3RUMUZCZUd0NE5IRk1OVkZYVkUxalZsaEMiLCJzZXNzaW9uX3N0YXRlIjoiOGRmOTJmZGItOWRiYS00ZDU4LWJhYWItODQ1NWYyM2UyNzM0IiwiYXRfaGFzaCI6InNNMzJNb1pGOTh4ZGRFbmNOaHpScnciLCJhY3IiOiIxIiwic2lkIjoiOGRmOTJmZGItOWRiYS00ZDU4LWJhYWItODQ1NWYyM2UyNzM0IiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJrZXRhbiBtb2RpIiwicHJlZmVycmVkX3VzZXJuYW1lIjoia2V0YW4ucmVsaWVmYXBwc0BnbWFpbC5jb20iLCJnaXZlbl9uYW1lIjoia2V0YW4iLCJmYW1pbHlfbmFtZSI6Im1vZGkiLCJlbWFpbCI6ImtldGFuLnJlbGllZmFwcHNAZ21haWwuY29tIn0.UzGQxImd_N15G1GAI_G4yqsEoKgr__P2LpadH8EMjpYfI4g15NHnrbZFeVfmCjpgDC3ujhzHtcDi2VhIdVQj_-P4IxbWzDR8XUt4cKZB2UpBjOx8B4Lwhku6iNXLTiyJ_mLosmhIhg9v2HO2BbnaouzJ86tglAeFXJD4yJlM1lX2CBYX46Xi0FDBGTsbHlAxk87GBinTVr7IrJak3xFD5uCdS5oqomBSULf78Q-DjTcaE-ansJIuURDHd798b_6ZGqW1RpT_OJmwemcheQlNQQk6oziKgGa-UCVN0rh7E6brLl0K6nGDl428k8ZKMXmCN8tT0g7DGbJIUMbjZq2GAw');
    });    
    await page.goto('http://localhost:4200/applications/63d7c683151406016afeabba/dashboard/63d90a49f1460400c282e152', { waitUntil: 'networkidle0' });

    const cookies = [{
        'name': 'apollo-server-landing-page-redirect-to-studio-local',
        'value': 'false'
    }];

    await page.setCookie(...cookies);
    
    await page.pdf({path: moment().format('HH:mm:ss')+'.pdf', format: 'A4', printBackground:true });

    await browser.close();
}

generatePdf();